# Лабораторная работа №3!!!

Let's get it started

Поехали

Что такое вообще CI и CD? Как было выяснено, это такая методология, при помощи которой мы можем достаточно сильно упростить себе жизнь. Мы можем ускорить внедрение изменений. Вместе с ними можно автоматизировать все протекающие процессы. Каждый человек, участвующий в разработке продукта, будет заниматься своим делом, остальное будет произведено через CI и CD. Тестики, всякие проверки и развертывания - все это реально прописать и производить через пайплайны. Красиво.

## Начнем выполнять задания

Глянем что у нас в файликах.

### Bad_file

![2024-10-20_23-14-57](https://github.com/user-attachments/assets/4820b2bd-75a2-41b2-b9a6-06c47ed10981)

Тут есть пара не совсем удачных моментов:

- Отсутствие кэширования

Кэширование помогает сократить время выполнения пайплайна. Чтобы не загружать все зависимости заново, необходимо использовать кэширование.

- Сборка и прохождение тестов в одной джобе

Такая практика затрудняет отладку ошибок.

- Проверка на сборку и тесты

Никак не связаны между собой `tests`, `build` и `deploy`. Намного правильнее будет разделить все эти процессы в разные джобы и связать их между собой, чтобы `build`, к примеру, выполнялся только после успешных `tests`, а `deploy` выполнялся только после `build`. Если связать эти процессы между собой, то уже после провальных тестов точно ничего выполняться не будет.

- Отсутствие `lint`

Если не добавлять линтинг как отдельную джобу, то это может привести к ухудшению качества кода.

- Отсутствие проверок на нескольких версиях

Если, к примеру, приложение деплоится на несколько машин/несколько окружений, то нам может быть важно, чтобы поддерживалось несколько версий Node.

### Good_file

![2024-11-27_04-00-57](https://github.com/user-attachments/assets/78a7688d-fdd7-4751-9f22-80f5c0bb6959)

![2024-11-27_04-01-08](https://github.com/user-attachments/assets/b6cee911-ea8e-41ab-8fd0-b7d69692b078)

Здесь все недочеты были исправлены.

- Добавлено кэширование, которое способствует ускорению времени выполнения workflows:

```
- name: Cache deps
  uses: actions/cache@v3
  with:
    path: ~/.npm
    key: ${{ runner.os }}-npm-${{ hashFiles('**/package-lock.json') }}
    restore-keys: |
      ${{ runner.os }}-npm-
```

- Все действия разделены по разным джобам

Теперь у нас есть несколько джоб, каждая отвечает за свои задачи. Код стал более гибким и понятным.

- Связь нескольких джоб между собой

Джобы стали зависимы. Теперь сборка требует успешных тестов, а деплоинг требует сборки. В каждой джобе прописан параметр `needs`, в котором указано, что именно требуется для выполнения текущей джобы.

- Добавлен `lint`

Линтинг кода проверяет его на ошибки и соответствие стандартам. Улучшается качество и читаемость самого кода, решаются проблемы с форматированием.

- Проверка на нескольких версиях Node.

Теперь проект может быть протестирован на нескольких версиях Node. Для этого в джобу с тестами было прописано:

```
strategy:
  matrix:
    version: [14, 16, 18]
```

А также был добавлен степ:

```
- uses: actions/setup-node@v3
  with:
    node-version: ${{ matrix.version }}
```

Теперь у нас происходит проверка на трех версиях. При помощи прописания `strategy` и `matrix` мы можем повторять выполнение строчек пайплайна для нескольких параметров.

Привожу примеры запуска пайплайнов:

Bad file:

![2024-11-17_21-08-18](https://github.com/user-attachments/assets/b9bdebe4-4988-4524-956c-1a467af95aba)

![2024-11-17_21-08-38](https://github.com/user-attachments/assets/b7201699-b8bf-4320-91f1-8c87a0f3cd0d)

Good file:

![2024-11-27_03-55-46](https://github.com/user-attachments/assets/a491a96a-d8f0-45dc-a763-a1f7b3354cb5)

![2024-11-27_03-56-01](https://github.com/user-attachments/assets/bb6b34d7-1058-44b6-a624-60fda7724d9d)

Запуски проводились в приватном репозитории.

На этом все, отчет завершен!

## Концовочка

Большое спасибо за лабораторную работу, было очень интересно разбираться с CI/CD, были просмотрены несколько видео по настройке пайплайнов и прочитаны соответствующие статьи, крутая лаба и полезная информация!
